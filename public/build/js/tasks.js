!function(){let e=[];!async function(){try{const t="/api/tasks?url="+i(),n=await fetch(t),a=await n.json();e=a.tasks,o()}catch(e){console.log(e)}}();let t=[],n="";document.querySelector("#add-task").addEventListener("click",(function(){c()}));function a(e){n=e.target.value,s()}function s(){""!==n&&(t=e.filter(e=>e.state===n)),o()}function o(){!function(){const e=document.querySelector("#tasks-list");for(;e.firstChild;)e.removeChild(e.firstChild)}(),function(){const t=e.filter(e=>"0"===e.state),n=document.querySelector("#pending");0===t.length?n.disabled=!0:n.disabled=!1}(),function(){const t=e.filter(e=>"1"===e.state),n=document.querySelector("#completed");0===t.length?n.disabled=!0:n.disabled=!1}();const a=""===n?e:t;if(0===a.length){const e=document.querySelector("#tasks-list"),t=document.createElement("LI");return t.textContent="No tasks",t.classList.add("no-tasks"),void e.appendChild(t)}const o={0:"Pending",1:"Completed"};a.forEach(t=>{const n=document.createElement("LI");n.dataset.taskId=t.id,n.classList.add("task");const a=document.createElement("P");a.textContent=t.name,a.ondblclick=function(){c(!0,{...t})};const l=document.createElement("DIV");l.classList.add("options");const u=document.createElement("BUTTON");u.classList.add("task-state"),u.classList.add(""+o[t.state].toLowerCase()),u.textContent=o[t.state],u.dataset.taskState=t.state,u.ondblclick=function(){!function(e){const t="1"===e.state?"0":"1";e.state=t,r(e)}({...t})};const m=document.createElement("BUTTON");m.classList.add("delete-task"),m.dataset.taskId=t.id,m.textContent="Delete",m.ondblclick=function(){!async function(t){Swal.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonText:"Cancel",confirmButtonText:"Yes, delete it!"}).then(n=>{n.isConfirmed&&(!async function(t){const{id:n,name:a,state:o}=t,c=new FormData;c.append("id",n),c.append("name",a),c.append("state",o),c.append("url",i());try{const n="/api/task/delete",a=await fetch(n,{method:"POST",body:c}),o=await a.json();o.result&&d(o.message,o.type,document.querySelector(".container-new-task")),e=e.filter(e=>e.id!==t.id),s()}catch(e){console.log(e)}}(t),Swal.fire("Deleted!","Your task has been deleted.","success"))})}({...t})},l.appendChild(u),l.appendChild(m),n.appendChild(a),n.appendChild(l);document.querySelector("#tasks-list").appendChild(n)})}function c(t=!1,n={}){const a=document.createElement("DIV");a.classList.add("modal"),a.innerHTML=`\n            <form class="form new-task">\n                <legend>${n.name?"UpDate Task":"Add New Task"}</legend>\n                <div class="field">\n                    <label>Task</label>\n                    <input type="text" id="task" name="task" autocomplete="taskname"\n                        placeholder="${n.name?"Edit Task":"Add Task to Current Project"}"\n                        value="${n.name?n.name:""}"\n                    />\n                </div>\n                <div class="options">\n                    <input type="submit" class="${n.name?"submit-update-task":"submit-new-task"}"  value="${n.name?"UpDate Task":"Add New Task"}"/>\n                    <button type="button" class="close-modal">Cancel</button>\n                </div>\n            </form>\n            `,setTimeout(()=>{document.querySelector(".form").classList.add("animate")},300),a.addEventListener("click",(function(o){if(o.preventDefault(),o.target.classList.contains("close-modal")||o.target.classList.contains("modal")){document.querySelector(".form").classList.add("close"),setTimeout(()=>{a.remove()},300)}if(o.target.classList.contains("submit-update-task")||o.target.classList.contains("submit-new-task")){const a=document.querySelector("#task").value.trim();if(""===a){return void d("Task Name is Required","error",document.querySelector(".form legend"))}reference=document.querySelector(".error"),reference&&reference.remove(),t?(n.name=a,r(n,!0)):async function(t){const n=new FormData;n.append("name",t),n.append("url",i());try{const a="/api/task",o=await fetch(a,{method:"POST",body:n}),c=await o.json();if(d(c.message,c.type,document.querySelector(".form legend")),"success"===c.type){const n=document.querySelector(".modal");setTimeout(()=>{n.remove()},3500);const a={id:String(c.id),name:t,projectid:c.projectid,state:"0"};e=[...e,a],s()}}catch(e){console.log(e)}}(a)}})),document.querySelector(".dashboard").appendChild(a)}function d(e,t,n){earlyAlert=document.querySelector(".alert"),earlyAlert&&earlyAlert.remove();const a=document.createElement("DIV");a.classList.add("alert",t),a.textContent=e,n.parentElement.insertBefore(a,n.nextElementSibling),setTimeout(()=>{a.remove()},3500)}async function r(t,n=!1){const{id:a,name:o,state:c}=t,r=new FormData;r.append("id",a),r.append("name",o),r.append("state",c),r.append("url",i());try{const t="/api/task/update",i=await fetch(t,{method:"POST",body:r}),l=await i.json();if("success"===l.response.type)if(n){d(l.response.message,l.response.type,document.querySelector(".form legend"));const e=document.querySelector(".modal");setTimeout(()=>{e.remove()},3500)}else d(l.response.message,l.response.type,document.querySelector(".container-new-task"));e=e.map(e=>(e.id===a&&(e.state=c,e.name=o),e)),s()}catch(e){console.log(e)}}function i(){const e=new URLSearchParams(window.location.search);return Object.fromEntries(e.entries()).url}document.querySelectorAll('#filters input[type="radio"]').forEach(e=>{e.addEventListener("input",a)})}();